# ใช้ postgres 17 เป็นฐาน
FROM postgres:17

# ติดตั้ง extensions และ tools ที่จำเป็น
RUN apt-get update && apt-get install -y \
    postgresql-contrib \
    netcat-traditional \
    && rm -rf /var/lib/apt/lists/*

# เพิ่ม custom configurations (ถ้ามี)
COPY ./db/postgresql.conf /etc/postgresql/postgresql.conf

# สร้าง directory สำหรับ init scripts
RUN mkdir -p /docker-entrypoint-initdb.d

# คัดลอก init scripts (ถ้ามี)
COPY ./db/init-scripts/ /docker-entrypoint-initdb.d/

# สั่งให้ postgres ใช้ config file ของเรา
CMD ["postgres", "-c", "config_file=/etc/postgresql/postgresql.conf"]

# Port ที่ใช้งาน
EXPOSE 5432
